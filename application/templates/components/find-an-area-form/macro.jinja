{% macro dlFindAnAreaForm(params) %}

{% set search_query = params.get("search_query", "") %}
{% set search_result = params.get("search_result", {}) %}
{% set url_query_params = params.get("url_query_params", []) %}

<form class="dl-find-an-area-form" method="get" id="dl-find-an-area-form">
  <div class="govuk-form-group">
    <h2 class="govuk-label-wrapper">
      <label class="govuk-label govuk-label--l" for="find-an-area">
        Find an area
      </label>
    </h2>
    <div id="find-an-area-hint" class="govuk-hint">
      Search by a postcode, or a Unique Property Reference Number (UPRN)
    </div>
    <input class="govuk-input govuk-input--width-20" id="find-an-area" name="q" type="text" spellcheck="false" aria-describedby="find-an-area-hint" value="{{ search_query }}">

    {# Include any additional hidden fields for URL query parameters, without "q" #}
    {% for param_name, param_value in url_query_params %}
      {% if param_name != "q" %}
        <input type="hidden" name="{{ param_name }}" value="{{ param_value }}">
      {% endif %}
    {% endfor %}
  </div>
  <button type="submit" class="govuk-button govuk-button--start" data-module="govuk-button">
    Find
    <svg class="govuk-button__start-icon" xmlns="http://www.w3.org/2000/svg" width="17.5" height="19" viewBox="0 0 33 40" aria-hidden="true" focusable="false">
      <path fill="currentColor" d="M0 0h13l20 20-20 20H0l20-20z" />
    </svg>
  </button>
</form>

{% if search_result %}
  <div class="govuk-!-margin-top-6 govuk-!-margin-bottom-6">
    <h2 class="govuk-heading-m">Search results</h2>
    <p class="govuk-body">
      {% if search_result.get("type") == "postcode" and search_result.get("result") %}
        Showing results for postcode: {{ search_result.get("result", {}).get("POSTCODE", {}) }}
      {% elif search_result.get("type") == "uprn" and search_result.get("result") %}
        Showing results for UPRN: {{ search_result.get("result", {}).get("UPRN", {}) }}
      {% else %}
        No results found for '{{ search_query }}'.
      </p>
      <p class="govuk-body">
        Check <a href=https://design.planning.data.gov.uk/what-we-are-working-on>our current priorities</a> to see if this data is being prepared for the platform.
      </p>
      <p class="govuk-body">
        If it's not there, you can <a href=https://design.planning.data.gov.uk/get-involved-in-designing-data>contribute to our data design process</a> to help prioritise it.
      {% endif %}
    </p>
  </div>
{% endif %}

{% endmacro %}
